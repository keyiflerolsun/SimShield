<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SimShield IoT Fleet Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static_home', path='CSS/iot-dashboard.css') }}">
  <link rel="shortcut icon" href="{{ url_for('static_home', path='favicon.ico') }}" type="image/x-icon"/>
</head>
<body>
  <div class="container">
    <header>
      <h1>
        <span class="shield-icon">ğŸ›¡ï¸</span>
        SimShield IoT Fleet Dashboard
      </h1>
      <div class="controls">
        <div class="header-panels">
          <button id="alerts-btn" class="alerts-btn" title="CanlÄ± uyarÄ±larÄ± gÃ¶ster">ğŸ”´ UyarÄ±lar <span class="alerts-count" id="alerts-count">0</span></button>
          <button id="actions-btn" class="actions-btn" title="Oturum geÃ§miÅŸini gÃ¶ster">ğŸ—‚ï¸ GeÃ§miÅŸ</button>
        </div>
        
        <div class="connection-status-panel">
          <div class="connection-item">
            <span class="status-dot" id="ws-dot"></span>
            <span id="ws-status">baÄŸlanÄ±yor...</span>
            <small style="color: var(--muted); margin-left: 4px;">WebSocket</small>
          </div>
          <div class="connection-item">
            <span class="status-dot api-dot connected" id="api-dot"></span>
            <span id="api-status">baÄŸlanÄ±yor...</span>
            <small style="color: var(--muted); margin-left: 4px;">REST API</small>
          </div>
        </div>
        
        <div class="header-actions">
          <button id="refresh" title="Filo verilerini yenile">ğŸ”„ Filo Yenile</button>
          <button id="analyze-all-btn" class="secondary" title="Filodaki tÃ¼m SIM kartlarÄ±nÄ± toplu olarak analiz et">ğŸ” TÃ¼m SIM'leri Analiz Et</button>
        </div>
      </div>
    </header>

    <!-- Ana Konteyner -->
    <div class="main-container">
      <!-- Ä°statistikler -->
      <div class="stats-grid">
        <div class="stat-item clickable-stat" data-filter="all" title="TÃ¼m SIM'leri gÃ¶ster">
          <div class="stat-value" id="total-sims">-</div>
          <div class="stat-label">Toplam SIM</div>
        </div>
        <div class="stat-item clickable-stat" data-filter="active" title="Sadece aktif SIM'leri gÃ¶ster">
          <div class="stat-value" id="active-sims">-</div>
          <div class="stat-label">Aktif</div>
        </div>
        <div class="stat-item clickable-stat" data-filter="high-risk" title="Sadece yÃ¼ksek riskli SIM'leri gÃ¶ster">
          <div class="stat-value" id="high-risk-sims">-</div>
          <div class="stat-label">YÃ¼ksek Risk</div>
        </div>
        <div class="stat-item clickable-stat" data-filter="anomaly" title="Sadece anomalili SIM'leri gÃ¶ster">
          <div class="stat-value" id="anomaly-count">-</div>
          <div class="stat-label">Anomali</div>
        </div>
      </div>

      <div class="grid">
        <div class="left-panel">
          <div class="card fleet-card">
            <div class="section-title">SIM Filosu</div>
            
            <!-- Arama ve Filtreler -->
            <input type="text" class="search-box" id="search-input" placeholder="SIM ID veya cihaz tÃ¼rÃ¼ ara...">
            
            <div class="filter-row">
              <select class="filter-select" id="risk-filter">
                <option value="">TÃ¼m Risk</option>
                <option value="red">YÃ¼ksek</option>
                <option value="orange">Orta</option>
                <option value="green">DÃ¼ÅŸÃ¼k</option>
              </select>
              <select class="filter-select" id="status-filter">
                <option value="">TÃ¼m Durum</option>
                <option value="active">Aktif</option>
                <option value="blocked">Engelli</option>
                <option value="suspended">AskÄ±da</option>
              </select>
              <select class="filter-select" id="city-filter">
                <option value="">TÃ¼m Åehir</option>
              </select>
            </div>
            
            <div class="muted">Listeden bir SIM seÃ§in â€” saÄŸ panelde detay gÃ¶zÃ¼kecek.</div>
            <div class="list" id="fleet-list">YÃ¼kleniyor...</div>
          </div>
        </div>

        <div class="card sim-detail-card">
          <!-- Header -->
          <div class="sim-detail-header">
            <div class="sim-detail-title">
              <div class="section-title">SIM DetayÄ±</div>
              <div id="selected-sim-name" class="sim-name">HiÃ§bir SIM seÃ§ilmedi</div>
              <div id="selected-sim-meta" class="sim-meta">â€”</div>
            </div>
            <div class="sim-header-actions">
              <button id="analyze-btn" class="secondary" disabled title="SeÃ§ili SIM kartÄ±nÄ± detaylÄ± analiz et">ğŸ” Analiz Et</button>
            </div>
          </div>

          <!-- Sticky Actions Toolbar -->
          <div class="sticky-actions-toolbar" id="sticky-actions">
            <div class="actions-label">HÄ±zlÄ± Aksiyonlar:</div>
            <div class="actions-buttons">
              <button id="notify-btn" class="action-btn action-notify" disabled title="UyarÄ± bildirimi gÃ¶nder">
                ğŸ“¢ <span class="action-text">Bildir</span>
              </button>
              <button id="throttle-btn" class="action-btn action-throttle" disabled title="BaÄŸlantÄ± hÄ±zÄ±nÄ± sÄ±nÄ±rla">
                ğŸŒ <span class="action-text">YavaÅŸlat</span>
              </button>
              <button id="freeze-btn" class="action-btn action-freeze danger" disabled title="24 saat boyunca dondur">
                â„ï¸ <span class="action-text">Dondur</span>
              </button>
              <button id="best-options-btn" class="action-btn action-best secondary" disabled title="En iyi seÃ§enekleri analiz et">
                ğŸ’¡ <span class="action-text">SeÃ§enekler</span>
              </button>
              <button id="whatif-btn" class="action-btn action-whatif secondary" disabled title="SimÃ¼lasyon senaryolarÄ±">
                ğŸ”® <span class="action-text">SimÃ¼lasyon</span>
              </button>
            </div>
          </div>

          <!-- Tab Navigation -->
          <div class="tab-navigation">
            <button class="tab-btn active" data-tab="overview">ğŸ“Š Genel BakÄ±ÅŸ</button>
            <button class="tab-btn" data-tab="charts">ğŸ“ˆ KullanÄ±m GrafiÄŸi</button>
          </div>

          <!-- Tab Content -->
          <div class="tab-content">
            <!-- Overview Tab -->
            <div class="tab-pane active" id="tab-overview">
              <!-- Anomaly Alert Section (only shows when anomalies exist) -->
              <div class="anomaly-alert-section" id="anomaly-alert-section" style="display: none;">
                <div class="anomaly-alert-header">
                  <span class="anomaly-icon">âš ï¸</span>
                  <span class="anomaly-title">Anomali Tespit Edildi!</span>
                  <span class="anomaly-count" id="anomaly-count-badge">0</span>
                </div>
                <div class="anomaly-alert-content" id="anomaly-alert-content">
                  <!-- Dynamic anomaly content will be inserted here -->
                </div>
              </div>

              <!-- SIM Details -->
              <div class="sim-details" id="sim-details">
                <div class="muted">SIM seÃ§ildiÄŸinde detaylar gÃ¶zÃ¼kecek</div>
              </div>
            </div>

            <!-- Charts Tab -->
            <div class="tab-pane" id="tab-charts">
              <div class="section-subtitle">30 GÃ¼n KullanÄ±m Trendi</div>
              <div class="chart" id="usage-chart">
                <div class="muted">SIM seÃ§ildiÄŸinde grafik gÃ¶zÃ¼kecek</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Floating Panels -->
    
    <!-- CanlÄ± UyarÄ±lar Paneli -->
    <div class="floating-panel" id="alerts-panel">
      <div class="floating-panel-header">
        <h3>ğŸ”´ CanlÄ± UyarÄ±lar</h3>
        <div class="floating-panel-controls">
          <div class="alerts-count-panel" id="alerts-count-panel">0</div>
          <button class="toggle-sound-btn-panel" id="toggle-sound-panel" title="Ses bildirimleri">ğŸ”Š</button>
          <button class="close-btn" id="close-alerts">Ã—</button>
        </div>
      </div>
      <div class="floating-panel-content">
        <div class="alerts-list-panel" id="alerts-list-panel">
          <div class="alert-placeholder">
            <div class="alert-placeholder-icon">ğŸ“¡</div>
            <div class="alert-placeholder-text">WebSocket baÄŸlantÄ±sÄ± bekleniyor...</div>
          </div>
        </div>
      </div>
      <div class="floating-panel-footer">
        <button class="clear-alerts-btn" id="clear-alerts-panel">ğŸ—‘ï¸ TÃ¼mÃ¼nÃ¼ Temizle</button>
        <button class="export-alerts-btn" id="export-alerts">ğŸ“¤ DÄ±ÅŸa Aktar</button>
      </div>
    </div>

    <!-- Oturum GeÃ§miÅŸi Paneli -->
    <div class="floating-panel" id="actions-panel">
      <div class="floating-panel-header">
        <h3>ğŸ—‚ï¸ Oturum Ä°ÅŸlem GeÃ§miÅŸi</h3>
        <div class="floating-panel-controls">
          <button class="close-btn" id="close-actions">Ã—</button>
        </div>
      </div>
      <div class="floating-panel-content">
        <div class="actions-log-panel" id="actions-log-panel">
          <div class="action-placeholder">
            <div class="action-placeholder-icon">ğŸ“‹</div>
            <div class="action-placeholder-text">HenÃ¼z iÅŸlem yapÄ±lmadÄ±<br>SIM iÅŸlemleri burada gÃ¶rÃ¼necek</div>
          </div>
        </div>
      </div>
      <div class="floating-panel-footer">
        <button class="clear-actions-btn" id="clear-actions-panel">ğŸ—‘ï¸ GeÃ§miÅŸi Temizle</button>
        <button class="export-actions-btn" id="export-actions">ğŸ“¤ DÄ±ÅŸa Aktar</button>
      </div>
    </div>

    <footer>
      SimShield IoT Fleet Guardian Â© 2025
    </footer>
  </div>

  <script src="{{ url_for('static_home', path='JS/iot-dashboard.js') }}"></script>
</body>
</html>
